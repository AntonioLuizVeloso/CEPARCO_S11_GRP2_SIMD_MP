# CEPARCO_S11_GRP2_SIMD_MP

<h3> i.) Screenshot of the Program Output with Execution Time for All Cases </h3>

<h4> DEBUG, Vector size n = 2^20 </h4>

<img src = "https://github.com/AntonioLuizVeloso/CEPARCO_S11_GRP2_SIMD_MP/assets/92433849/cdbd4072-f892-428a-bce2-9e7784041272" height = "500" width = "400"> <img src = "https://github.com/AntonioLuizVeloso/CEPARCO_S11_GRP2_SIMD_MP/assets/92433849/fac3929c-e018-4893-971d-c8a6c8861fe1" height = "500" width = "400"> <img src = "https://github.com/AntonioLuizVeloso/CEPARCO_S11_GRP2_SIMD_MP/assets/92433849/47fcca2b-6457-489a-93ac-1a9390460fbd" height = "500" width = "400"> <img src = "https://github.com/AntonioLuizVeloso/CEPARCO_S11_GRP2_SIMD_MP/assets/92433849/97bd101c-10dc-4358-ad1b-d4f84790b055" height = "500" width = "400">

<h4> DEBUG, Vector size n = 2^26 </h4>

<img src = "https://github.com/AntonioLuizVeloso/CEPARCO_S11_GRP2_SIMD_MP/assets/92433849/fc34a33d-35c7-4a56-b33f-7df38ae054e7" height = "500" width = "400"> <img src = "https://github.com/AntonioLuizVeloso/CEPARCO_S11_GRP2_SIMD_MP/assets/92433849/35fc7e25-928b-49a0-9d6e-e38c89bc37fc" height = "500" width = "400"> <img src = "https://github.com/AntonioLuizVeloso/CEPARCO_S11_GRP2_SIMD_MP/assets/92433849/4e5f3602-b584-4b17-99ea-cef17e097cda" height = "500" width = "400"> <img src = "https://github.com/AntonioLuizVeloso/CEPARCO_S11_GRP2_SIMD_MP/assets/92433849/1350ae30-1bb6-4240-aa8c-38bc9b752ae3" height = "500" width = "400">

<h4> DEBUG, Vector size n = 2^27 </h4>

<img src = "https://github.com/AntonioLuizVeloso/CEPARCO_S11_GRP2_SIMD_MP/assets/119172963/e373ad69-cd3f-4538-ac2a-99360d249893" height = "500" width = "400"> <img src = "https://github.com/AntonioLuizVeloso/CEPARCO_S11_GRP2_SIMD_MP/assets/119172963/656b5909-db14-4855-86b3-68fe32697b94" height = "500" width = "400"> <img src = "https://github.com/AntonioLuizVeloso/CEPARCO_S11_GRP2_SIMD_MP/assets/119172963/94b54daa-527d-4da8-8577-5efdc41596d9" height = "500" width = "400"> <img src = "https://github.com/AntonioLuizVeloso/CEPARCO_S11_GRP2_SIMD_MP/assets/119172963/baffba25-115e-4587-b4d7-9c3769b70de0" height = "500" width = "400">

<h4> RELEASE, Vector size n = 2^20 </h4>

<img src = "https://github.com/AntonioLuizVeloso/CEPARCO_S11_GRP2_SIMD_MP/assets/92433849/7af418a2-0869-4a53-8bb7-3ea46d2db3e2" height = "500" width = "400"> <img src = "https://github.com/AntonioLuizVeloso/CEPARCO_S11_GRP2_SIMD_MP/assets/92433849/594e95ae-e099-4c8c-a3a2-d3de90758104" height = "500" width = "400"> <img src = "https://github.com/AntonioLuizVeloso/CEPARCO_S11_GRP2_SIMD_MP/assets/92433849/cca51727-9cd4-4a7b-a058-87000d14dbcc" height = "500" width = "400"> <img src = "https://github.com/AntonioLuizVeloso/CEPARCO_S11_GRP2_SIMD_MP/assets/92433849/e1613915-4c9d-48ae-b5f4-f4b9e983bf44" height = "500" width = "400">

<h4> RELEASE, Vector size n = 2^26 </h4>

<img src = "https://github.com/AntonioLuizVeloso/CEPARCO_S11_GRP2_SIMD_MP/assets/92433849/95e4e295-d446-4530-8046-bfa4f764cff0" height = "500" width = "400"> <img src = "https://github.com/AntonioLuizVeloso/CEPARCO_S11_GRP2_SIMD_MP/assets/92433849/b0bbddc5-c525-454e-be29-0ee6de4a67e3" height = "500" width = "400"> <img src = "https://github.com/AntonioLuizVeloso/CEPARCO_S11_GRP2_SIMD_MP/assets/92433849/f50dd44a-03e5-43a2-9d5d-88488c41eb80" height = "500" width = "400"> <img src = "https://github.com/AntonioLuizVeloso/CEPARCO_S11_GRP2_SIMD_MP/assets/92433849/f8205ac5-a37e-4754-9616-9ced4aa9610a" height = "500" width = "400">

<h4> RELEASE, Vector size n = 2^30 </h4>

<img src = "https://github.com/AntonioLuizVeloso/CEPARCO_S11_GRP2_SIMD_MP/assets/119172963/1595ee7b-9035-488c-b52f-cb60ffb25d4a" height = "500" width ="400"> 
<img src = "https://github.com/AntonioLuizVeloso/CEPARCO_S11_GRP2_SIMD_MP/assets/119172963/d5748b38-65ca-4e7b-8de6-39f0ceb324ff" height = "500" width ="400"> <img src = "https://github.com/AntonioLuizVeloso/CEPARCO_S11_GRP2_SIMD_MP/assets/119172963/86b5fdeb-3fd6-4a99-9c00-16e6a2fcc902" height = "500" width ="400"> <img src = "https://github.com/AntonioLuizVeloso/CEPARCO_S11_GRP2_SIMD_MP/assets/119172963/802aa377-3a56-424e-9fa3-0913529dac9f" height = "500" width = "400">

ii.) Comparative Table of Execution Time + Analysis of the Performance of Different Kernels

| Version | Kernel | Execution Time for n = 2<sup>20</sup> | Execution Time for n = 2<sup>26</sup> | Execution Time for n = 2<sup>30</sup> |
| --- | --- | --- | --- | --- |
| Debug | C | 4.352280 ms | 165.044217 ms | n/a |
| Release | C | 0.514263 ms | 38.037137 ms | 2.346349 s |
| Debug | NON-SIMD | 7.154423 ms | 243.168383 ms | n/a |
| Release | NON-SIMD | 4.653573 ms | 239.715557 ms | 5.946140 s|
| Debug | SIMD w/ XMM | 1.195450 ms | 44.066440 ms | n/a |
| Release | SIMD w/ XMM | 0.880623 ms | 39.116787 ms | 1.970389 s|
| Debug | SIMD w/ YMM | 0.023947 ms | 1.266637 ms | n/a |
| Release | SIMD w/ YMM | 0.017117 ms | 1.130136 ms | 1.337666 s|

<h5 align = "justify">
  As shown in the table above, for the Debug Version, it can be observed that YMM is faster than XMM, which is faster than C, which is faster than Non-SIMD. This stays mostly the same for the Release version, except that C becomes slightly faster than the XMM implementation. Further, the Release Version is much faster than the Debug version because the Release Version of Visual Studio tries to generally optimize performance. An interesting and somewhat unfortunate observation is that for size 2^30, Debug configuration results in an error caused by a null pointer determined to have been caused by a failed malloc() instruction, and upon further research the group tried to increase the virtual memory of the system but it unfortunately did not work, and yet on Release configuration the code works as intended. For Debug version, the maximum array size that does not cause an error is for size 2^27.
</h5>

<h5 align = "justify">
  YMM is the fastest simply because it can handle more data than all the other methods. XMM is the second fastest because while it is a large register type, it only has half the size of YMM, but it has an advantage in its packed characteristic over NON-SIMD. XMM becomes the third fastest in the Release version likely because of unoptimized code. C is the third fastest in general likely because while it is a high-level language that is probably already optimized, the instructions of the language itself cause some delay when compared to baseline assembly instructions. Non-SIMD is the slowest likely because of unoptimized code, but also because it is restricted to only handling single values only which accumulates in delay as the size gets larger.
</h5>

<h3> iii.) Screenshot of the Program Output w/ Correctness Check (C) </h3>

<img src = "https://github.com/AntonioLuizVeloso/CEPARCO_S11_GRP2_SIMD_MP/assets/92433849/06d5b3a4-f25d-4e75-a30f-62d862267559" width = "400">

<h5>
  This output will be compared to the outputs of other implementations to determine their correctness.
</h5>

<h3> iv.) Screenshot of the Program Output including Correctness Check (x86-64) </h3>

<img src = "https://github.com/AntonioLuizVeloso/CEPARCO_S11_GRP2_SIMD_MP/assets/92433849/ea2cdc56-d3ff-484a-9552-30678ace2f32" width = "400">

<h5>
  This output is the same as the C output, so it is correct.
</h5>

<h3> v.) Screenshot of the Program Output including Correctness Check (SIMD XMM Register) </h3>

<img src = "https://github.com/AntonioLuizVeloso/CEPARCO_S11_GRP2_SIMD_MP/assets/92433849/abaadf61-3ea3-46cf-ae43-f92a5623f181" width = "400">

<h5>
  This output is the same as the C output, so it is correct.
</h5>

<h3> vi.) Screenshot of the Program Output including Correctness Check (SIMD YMM Register) </h3>

<img src = "https://github.com/AntonioLuizVeloso/CEPARCO_S11_GRP2_SIMD_MP/assets/92433849/93bf8585-ca69-4fbd-b28b-6726c7f32204" width = "400">

<h5>
  This output is the same as the C output, so it is correct.
</h5>

<h3> vii.) Discussion of Problems Encountered and Solutions Implemented </h3>

<h5>
  The first interesting observation the group had was that in a stencil, the first Y value comes when **i=3**, allowing the formula to not result in an error, however since the Y vector supposedly should not be carrying empty values or zeros, this means that the stencil can be *shifted*. Instead of using Y[i] = X[i-3] + ... + X[i+3], the group used Y[i] = X[i] + X[i+1] +...+ X[i+6] instead.

  
  This idea was implemented in the assembly functions and not on the C function, for the sake of preserving the real formula. For NON-SIMD, the only real problem the group faced was incorrect addition of values, which was fixed by making sure the pointer of the vector after reaching **i+6** is subtracted back to **i+1** for the next Y vector value.

  
  For XMM and YMM SIMD, an interesting solution the group came up with was to make use of 2 registers, pack them with values, add those values to another output register, and reuse the first register by packing it with new values but shifted by 4 bytes. After 7 repeats of this simple process, there are now 4(for xmm, 8 for ymm) values that can be pushed onto the Y vector at the **price of one**.
</h5>

<h5>
  Because of the aforementioned solution to XMM and YMM SIMD, the boundary is handled fine and no errors occur when array size is ** (2^20)+3,(2^20)+5,(2^20)+6,(2^20)+9 **. Screenshots below are added for case (2^20)+9 run in Debug Configuration:
</h5>

<img src = "https://github.com/AntonioLuizVeloso/CEPARCO_S11_GRP2_SIMD_MP/assets/119172963/79b88dc2-f8f5-4d2c-b91d-c24c5e2bdf84" height = "500" width = "400">
<img src = "https://github.com/AntonioLuizVeloso/CEPARCO_S11_GRP2_SIMD_MP/assets/119172963/a745465c-4386-4062-8c09-817777e86c21" height = "500" width = "400">
<img src = "https://github.com/AntonioLuizVeloso/CEPARCO_S11_GRP2_SIMD_MP/assets/119172963/f0e3d5d4-9595-4e22-955a-1ad4717346e4" height = "500" width = "400">
<img src = "https://github.com/AntonioLuizVeloso/CEPARCO_S11_GRP2_SIMD_MP/assets/119172963/d66d720a-2bfb-4eb1-a0b8-34154127edd7" height = "500" width = "400">
